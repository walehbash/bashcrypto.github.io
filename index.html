
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CryptoBroker Pro - Advanced Trading Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="notification-container"></div>
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      </aside>

    <!-- Main Content -->
    <main class="main-content">
      </main>

    <!-- AI Chat Modal -->
    <div id="ai-chat-modal" style="display: none; position: fixed; ...">
        </div>

    <!-- Floating Action Button -->
    <div class="fab" id="ai-support-btn" title="Chat with Gemini AI">
      <i class="fas fa-robot"></i>
    </div>
  </div>

  <script type="module">
    import './theme.js';
    import { auth, db } from './firebase-config.js';
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
    import { showNotification } from './notifications.js';

    // Mock Gemini AI
    const gemini = {
        async sendMessage(message) {
            await new Promise(res => setTimeout(res, 1000 + Math.random() * 1000));
            message = message.toLowerCase();
            if(message.includes("hello") || message.includes("hi")) return "Hello there! How can I assist you with your crypto portfolio today?";
            if(message.includes("portfolio")) return "Your portfolio is looking strong! The market is volatile, but your assets are well-positioned.";
            if(message.includes("btc") || message.includes("bitcoin")) return "Bitcoin is currently trading at $68,500. It's showing strong support at $65,000.";
            if(message.includes("eth") || message.includes("ethereum")) return "Ethereum is at $3,500. The upcoming Dencun upgrade is expected to reduce transaction fees significantly.";
            return "I am a large language model, trained by Google."
        }
    }

    // Other JS code remains the same...
    // ... (event listeners, chart, etc.)

    // --- AI Chat --- //
    const aiChatModal = document.getElementById('ai-chat-modal');
    const aiSupportBtn = document.getElementById('ai-support-btn');
    const closeChatBtn = document.getElementById('close-chat-btn');
    const chatMessages = document.getElementById('chat-messages');
    const chatInput = document.getElementById('chat-input');
    const sendChatBtn = document.getElementById('send-chat-btn');

    aiSupportBtn.addEventListener('click', () => aiChatModal.style.display = 'block');
    closeChatBtn.addEventListener('click', () => aiChatModal.style.display = 'none');

    const addMessage = (content, sender) => {
        const messageEl = document.createElement('div');
        messageEl.classList.add('chat-message', `chat-message-${sender}`);
        messageEl.innerHTML = content;
        chatMessages.appendChild(messageEl);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    sendChatBtn.addEventListener('click', async () => {
        const message = chatInput.value.trim();
        if(!message) return;
        addMessage(message, 'user');
        chatInput.value = '';

        const aiResponse = await gemini.sendMessage(message);
        addMessage(aiResponse, 'ai');
    });

    chatInput.addEventListener('keypress', (e) => {
        if(e.key === 'Enter') sendChatBtn.click();
    });

  </script>
</body>
</html>
