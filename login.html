<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - CryptoBroker Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="firebase-config.js"></script>
  <style>
    .login-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #0f0d23 0%, #1e1b4b 100%);
      padding: 2rem;
    }

    .login-card {
      background: var(--dark);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 3rem;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .login-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo {
      width: 80px;
      height: 80px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
          justify-content: center;
      margin: 0 auto 1rem;
      font-size: 2rem;
      color: white;
      font-weight: 700;
    }

    .login-title {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .login-subtitle {
      color: var(--gray);
      font-size: 0.875rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--light);
    }

    .form-group input {
      width: 100%;
      padding: 0.875rem;
      background: var(--darker);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--light);
      font-size: 0.875rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .input-group {
      position: relative;
    }

    .input-group input {
      padding-right: 3rem;
    }

    .input-icon {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .input-icon:hover {
      color: var(--primary);
    }

    .login-btn {
      width: 100%;
      padding: 0.875rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 1rem;
    }

    .login-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }

    .login-btn:disabled {
      background: var(--gray);
      cursor: not-allowed;
      transform: none;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 1.5rem 0;
      color: var(--gray);
      font-size: 0.875rem;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }

    .divider span {
      padding: 0 1rem;
    }

    .social-login {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .social-btn {
      flex: 1;
      padding: 0.75rem;
      border: 1px solid var(--border);
      background: var(--darker);
      color: var(--light);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-size: 0.875rem;
    }

    .social-btn:hover {
      border-color: var(--primary);
      background: rgba(99, 102, 241, 0.1);
    }

    .login-footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
    }

    .login-footer a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }

    .login-footer a:hover {
      text-decoration: underline;
    }

    .otp-container {
      display: none;
    }

    .otp-container.show {
      display: block;
    }

    .otp-inputs {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    .otp-input {
      width: 50px;
      height: 50px;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--darker);
      color: var(--light);
    }

    .otp-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .resend-otp {
      text-align: center;
      margin-top: 1rem;
    }

    .resend-otp button {
      background: none;
      border: none;
      color: var(--primary);
      cursor: pointer;
      font-size: 0.875rem;
    }

    .resend-otp button:disabled {
      color: var(--gray);
      cursor: not-allowed;
    }

    .timer {
      color: var(--gray);
      font-size: 0.875rem;
    }

    @media (max-width: 480px) {
      .login-card {
        padding: 2rem;
      }
      
      .social-login {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="login-container">
    <div class="login-card">
      <div class="login-header">
        <div class="logo">
          <div class="logo-icon">
            <svg width="80" height="80" viewBox="0 0 32 32" fill="none">
              <rect width="32" height="32" rx="8" fill="#6366f1"/>
              <path d="M16 8C11.6 8 8 11.6 8 16C8 20.4 11.6 24 16 24C20.4 24 24 20.4 24 16C24 11.6 20.4 8 16 8ZM16 22C12.7 22 10 19.3 10 16C10 12.7 12.7 10 16 10C19.3 10 22 12.7 22 16C22 19.3 19.3 22 16 22Z" fill="white"/>
              <path d="M16 12C14.3 12 13 13.3 13 15C13 16.7 14.3 18 16 18C17.7 18 19 16.7 19 15C19 13.3 17.7 12 16 12ZM16 16C15.4 16 15 15.6 15 15C15 14.4 15.4 14 16 14C16.6 14 17 14.4 17 15C17 15.6 16.6 16 16 16Z" fill="white"/>
              <path d="M14 13H18V17H14V13Z" fill="#6366f1"/>
            </svg>
          </div>
        </div>
        <h1 class="login-title">CryptoBroker</h1>
        <p class="login-subtitle">Sign in to your account</p>
      </div>

      <!-- Login Form -->
      <form id="loginForm" class="login-form">
        <div class="form-group">
          <label for="email">Email or Phone Number</label>
          <div class="input-group">
            <input type="text" id="email" placeholder="Enter your email or phone" required>
            <i class="fas fa-envelope input-icon"></i>
          </div>
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <div class="input-group">
            <input type="password" id="password" placeholder="Enter your password" required>
            <i class="fas fa-eye input-icon" onclick="togglePassword()"></i>
          </div>
        </div>

        <button type="submit" class="login-btn" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i> Sign In
        </button>

        <div class="divider">
          <span>or continue with</span>
        </div>

        <div class="social-login">
          <button type="button" class="social-btn" onclick="socialLogin('google')">
            <i class="fab fa-google"></i>
            Google
          </button>
        </div>
      </form>

      <!-- OTP Form -->
      <form id="otpForm" class="otp-container">
        <div class="login-header">
          <h2 class="login-title">Verify OTP</h2>
          <p class="login-subtitle">Enter the 6-digit code sent to your device</p>
        </div>

        <div class="otp-inputs">
          <input type="text" class="otp-input" maxlength="1" data-index="0">
          <input type="text" class="otp-input" maxlength="1" data-index="1">
          <input type="text" class="otp-input" maxlength="1" data-index="2">
          <input type="text" class="otp-input" maxlength="1" data-index="3">
          <input type="text" class="otp-input" maxlength="1" data-index="4">
          <input type="text" class="otp-input" maxlength="1" data-index="5">
        </div>

        <button type="submit" class="login-btn" id="verifyOtpBtn">
          <i class="fas fa-check"></i> Verify OTP
        </button>

        <div class="resend-otp">
          <button type="button" id="resendBtn" onclick="resendOTP()">
            Resend Code
          </button>
          <span class="timer" id="timer"></span>
        </div>
      </form>

      <div class="login-footer">
        <p>Don't have an account? <a href="#" onclick="showSignup()">Sign up</a></p>
        <p><a href="#" onclick="forgotPassword()">Forgot password?</a></p>
      </div>
    </div>
  </div>

  <script>
    let otpTimer;
    let otpCode = '';

    // Toggle password visibility
    function togglePassword() {
      const passwordInput = document.getElementById('password');
      const icon = document.querySelector('.input-icon');
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    }

    // Social login
    function socialLogin(provider) {
      const btn = event.target.closest('.social-btn');
      const originalText = btn.innerHTML;

      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
      btn.disabled = true;

      const firebaseProvider = new firebase.auth.GoogleAuthProvider();

      firebase.auth().signInWithPopup(firebaseProvider)
        .then((result) => {
          // This gives you a Google Access Token. You can use it to access the Google API.
          const credential = result.credential;
          const token = credential.accessToken;
          // The signed-in user info.
          const user = result.user;
          console.log('Google login successful:', user);
          // Redirect to KYC verification
          window.location.href = 'kyc.html';
        })
        .catch((error) => {
          // Handle Errors here.
          const errorCode = error.code;
          const errorMessage = error.message;
          // The email of the user's account used.
          const email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          const credential = error.credential;
          alert('Error: ' + errorMessage);
          btn.innerHTML = originalText;
          btn.disabled = false;
        });
    }

    // Show signup
    function showSignup() {
      alert('Sign up functionality will be implemented with Firebase integration.');
    }

    // Forgot password
    function forgotPassword() {
      alert('Password reset functionality will be implemented with Firebase integration.');
    }

    // Generate OTP
    function generateOTP() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }

    // Show OTP form
    function showOTPForm() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('otpForm').classList.add('show');
      
      // Generate and store OTP
      otpCode = generateOTP();
      console.log('Demo OTP Code:', otpCode);
      
      // Start timer
      startOTPTimer();
      
      // Focus first OTP input
      setTimeout(() => {
        document.querySelector('.otp-input').focus();
      }, 100);
    }

    // Start OTP timer
    function startOTPTimer() {
      let timeLeft = 60;
      const timerElement = document.getElementById('timer');
      const resendBtn = document.getElementById('resendBtn');
      
      resendBtn.disabled = true;
      
      otpTimer = setInterval(() => {
        timeLeft--;
        timerElement.textContent = `(${timeLeft}s)`;
        
        if (timeLeft <= 0) {
          clearInterval(otpTimer);
          timerElement.textContent = '';
          resendBtn.disabled = false;
        }
      }, 1000);
    }

    // Resend OTP
    function resendOTP() {
      otpCode = generateOTP();
      console.log('New Demo OTP Code:', otpCode);
      
      // Clear inputs
      document.querySelectorAll('.otp-input').forEach(input => {
        input.value = '';
      });
      
      // Restart timer
      clearInterval(otpTimer);
      startOTPTimer();
      
      // Focus first input
      document.querySelector('.otp-input').focus();
      
      alert('New OTP code sent! (Check console for demo code)');
    }

    // Handle OTP input
    document.querySelectorAll('.otp-input').forEach((input, index) => {
      input.addEventListener('input', function() {
        if (this.value.length === 1) {
          if (index < 5) {
            document.querySelector(`[data-index="${index + 1}"]`).focus();
          }
        }
      });
      
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Backspace' && this.value === '' && index > 0) {
          document.querySelector(`[data-index="${index - 1}"]`).focus();
        }
      });
    });

    // Login form submission
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      
      if (!email || !password) {
        alert('Please fill in all fields');
        return;
      }
      
      const loginBtn = document.getElementById('loginBtn');
      loginBtn.disabled = true;
      loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
      
      // Simulate login process
      setTimeout(() => {
        showOTPForm();
        loginBtn.disabled = false;
        loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
      }, 2000);
    });

    // OTP form submission
    document.getElementById('otpForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const otpInputs = document.querySelectorAll('.otp-input');
      const enteredOTP = Array.from(otpInputs).map(input => input.value).join('');
      
      if (enteredOTP.length !== 6) {
        alert('Please enter the complete 6-digit OTP');
        return;
      }
      
      const verifyBtn = document.getElementById('verifyOtpBtn');
      verifyBtn.disabled = true;
      verifyBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';
      
      // Simulate OTP verification
      setTimeout(() => {
        if (enteredOTP === otpCode) {
          alert('Login successful! Redirecting to dashboard...');
          window.location.href = 'index.html';
        } else {
          alert('Invalid OTP code. Please try again.');
          verifyBtn.disabled = false;
          verifyBtn.innerHTML = '<i class="fas fa-check"></i> Verify OTP';
        }
      }, 1500);
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Login page loaded');
    });
  </script>
</body>
</html>